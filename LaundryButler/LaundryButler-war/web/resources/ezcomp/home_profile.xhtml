<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:cc="http://xmlns.jcp.org/jsf/composite"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough">

  <!-- INTERFACE -->
  <cc:interface>
  </cc:interface>

  <!-- IMPLEMENTATION -->
  <cc:implementation>
    <div class="row">
      <div class="col-sm-8">
        <h2>Hi, <h:outputText value="#{customerProfileManagedBean.customer.firstName}"/>!</h2><br/>
        <h4>Welcome to Laundry Butler home page.</h4><br/>
          <button class="btn btn-lg page_button" data-toggle="modal" data-target="#myProfile">My Profile</button>
          <button class="btn btn-lg page_button" data-toggle="modal" data-target="#myAddress">My Address Book</button>
          <button class="btn btn-lg page_button" data-toggle="modal" data-target="#myPassword">Change Password</button>

      </div>
      <!-- Modal windows myProfile-->
      <div class="modal fade" id="myProfile" role="dialog" style="padding-top:100px;">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header themeBg">
              <button type="button" class="close modal-close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title text-center">My Profile</h4>
            </div>
            <h:form class="form">
            <div class="modal-body">
              <h3 class="themeC">Account</h3>
              <div class="form-group">
                <h:outputLabel class="control-label" for="profile_email" value="Email: "/>
                <h:outputText id="profile_email"  class="input_text"  value="   #{customerProfileManagedBean.customer.email}"/>
              </div>
              
              <h3 class="themeC">Basic</h3>
              <div class="form-group">
                <h:outputLabel class="control-label" for="profile_firstName" value="First Name"/>
                <h:inputText id="profile_firstName"  class="form-control input_text"  value="#{customerProfileManagedBean.customer.firstName}" maxlength="32" required="true" requiredMessage="First Name is required"/>
              </div>
              
              <div class="form-group">
                <h:outputLabel class="control-label" for="profile_lastName" value="Last Name"/>
                <h:inputText id="profile_lastName"  class="form-control input_text"  value="#{customerProfileManagedBean.customer.lastName}" maxlength="32" required="true" requiredMessage="Last Name is required"/>
              </div>
              
              <h3 class="themeC">Contact</h3>
              <div class="form-group">
                <h:outputLabel class="control-label" for="profile_mobile" value="Mobile"/>
                <h:inputText id="profile_mobile"  class="form-control input_text"  value="#{customerProfileManagedBean.customer.mobile}" maxlength="32" required="true" requiredMessage="Last Name is required"/>
              </div>
              
            </div>
            <div class="modal-footer">
              <h:commandButton type="button" class="btn btn-default page_button" style="width:80px;" value="Save" actionListener="#{customerProfileManagedBean.updateCustomerProfile}" ><f:ajax execute="@form"/></h:commandButton>
              <button type="button" class="btn btn-default" data-dismiss="modal" style="width:80px;">Cancel</button>
            </div>
            </h:form>
          </div>
        </div>
      </div>
      
      <!-- Modal windows myAddress-->
      <div class="modal fade" id="myAddress" role="dialog" style="padding-top:100px;">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header themeBg">
              <button type="button" class="close modal-close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title text-center">My Address Book</h4>
            </div>
            <h:form class="form">
            <div class="modal-body">
              <h3 class="themeC">Existing Address</h3>
              <h3>#{customerProfileManagedBean.hasAddress}</h3>
              
              <ui:fragment rendered="#{customerProfileManagedBean.hasAddress}">
                <table class="table table-hover text-center">
                  <thead>
                    <td></td>
                    <td style="font-weight:bold; color:#000000;">Block</td>
                    <td style="font-weight:bold; color:#000000;">Street</td>
                    <td style="font-weight:bold; color:#000000;">Floor</td>
                    <td style="font-weight:bold; color:#000000;">Unit</td>
                    <td style="font-weight:bold; color:#000000;">Country</td>
                    <td style="font-weight:bold; color:#000000;">Postal Code</td>
                    <td class="text-right"></td>
                  </thead>
                  <tbody>
                      <ui:repeat var="address" value="#{customerProfileManagedBean.addresses}">
                      <tr data-toggle="collapse" data-target="#myAddressToggle#{address.addressId}" class="accordion-toggle">
                        <td style="font-weight: bold;color:#000000;">#{address.addressId}</td>
                        <td>#{address.block}</td>
                        <td>${address.street}</td>
                        <td>#{address.floor}</td>
                        <td>#{address.unit}</td>
                        <td>#{address.country}</td>
                        <td>#{address.postalCode}</td>
                        <td><i class="indicator glyphicon chevron_toggleable glyphicon-chevron-up pull-right"></i></td>
                      </tr>
                      
                      <tr>
                        <td colspan="8" class="hiddenRow">
                          <div id="myAddressToggle#{address.addressId}" class="accordian-body collapse">    
                            <h:form>    
                                <div class="row" style="padding:10px 0px; text-align: left;">
                                  <div class="col-md-6" >
                                    <h:outputLabel class="control-label" for="updateAddress_block" value="Block"/><br/>
                                    <h:inputText id="updateAddress_block" a:placeholder="#{address.block}" value="#{address.block}"/>
                                  </div>
                                  <div class="col-md-6" > 
                                    <h:outputLabel class="control-label" for="updateAddress_unit" value="Unit"/>  <br/>
                                    <h:inputText id="updateAddress_unit" a:placeholder="#{address.unit}" value="#{address.unit}"/> 
                                  </div>  
                                </div>
                                
                                <div class="row" style="padding:10px 0px; text-align: left;">
                                    <div class="col-md-6" >
                                        <h:outputLabel class="control-label" for="updateAddress_street" value="Street"/>  <br/>
                                        <h:inputText id="updateAddress_street" a:placeholder="#{address.street}" value="#{address.street}"/>
                                    </div>
                                    <div class="col-md-6">
                                        <h:outputLabel class="control-label" for="updateAddress_floor" value="Floor"/>  <br/>
                                        <h:inputText id="updateAddress_floor" a:placeholder="#{address.floor}" value="#{address.floor}"/> 
                                    </div>  
                                </div>
                                
                                <div class="row" style="padding:10px 0px; text-align: left;">
                                  <div class="col-md-6">  
                                      <h:outputLabel class="control-label" for="updateAddress_postalCode" value="Postal Code"/>   <br/> 
                                      <h:inputText id="updateAddress_postalCode" a:placeholder="#{address.postalCode}" value="#{address.postalCode}"/>
                                  </div>
                                  <div class="col-md-6"> 
                                    <h:outputLabel class="control-label" for="updateAddress_country" value="Country"/>    <br/>
                                    <h:inputText id="updateAddress_country" a:placeholder="#{address.country}" value="#{address.country}"/>
                                  </div>  
                                </div>  
                                
                                <div class="row" style="padding:20px 0px;">
                                    <div class="col-md-12">
                                        <div class="text-right">
                                            <h:commandButton type="button" class="btn btn-default page_button" style="width:80px;" value="Update" actionListener="#{customerProfileManagedBean.updateAddress()}" >
                                                <f:ajax execute="@form"/>
                                            </h:commandButton>
                                        </div>
                                    </div>    
                                </div> 
                            </h:form>  
                          </div>
                        </td>
                      </tr>
                    </ui:repeat>		
                  </tbody>		
                </table>
                <script>
                  $('.chevron_toggleable').on('click', function () {
                    $(this).toggleClass('glyphicon-chevron-down glyphicon-chevron-up');
                  });
                </script>
                </ui:fragment>
                <ui:fragment rendered="#{!customerProfileManagedBean.hasAddress }">
                  <p class="text-center">You don't have any address record yet.</p>
                </ui:fragment>
              
                <!-- Modal windows - My Address - Create new address-->
                <h:form>
                    <h3 class="themeC">Add New Address</h3>
                    <div class="form-group">
                        <h:outputLabel class="control-label" for="newAddress_block" value="Block"/>
                        <h:inputText id="newAddress_block"  class="form-control input_text"  value="#{customerProfileManagedBean.address.block}" maxlength="32" required="true" requiredMessage="Block is required"/>
                    </div>
                    <div class="form-group">
                        <h:outputLabel class="control-label" for="newAddress_street" value="Street"/>
                        <h:inputText id="newAddress_street"  class="form-control input_text"  value="#{customerProfileManagedBean.address.street}" maxlength="32" required="true" requiredMessage="Street is required"/>
                    </div>
                    <div class="form-group">
                        <h:outputLabel class="control-label" for="newAddress_floor" value="Floor"/>
                        <h:inputText id="newAddress_floor"  class="form-control input_text"  value="#{customerProfileManagedBean.address.floor}" maxlength="32" required="true" requiredMessage="Floor is required"/>
                    </div>
                    <div class="form-group">
                        <h:outputLabel class="control-label" for="newAddress_unit" value="Unit"/>
                        <h:inputText id="newAddress_unit"  class="form-control input_text"  value="#{customerProfileManagedBean.address.unit}" maxlength="32" required="true" requiredMessage="Unit is required"/>
                    </div>
                    <div class="form-group">
                        <h:outputLabel class="control-label" for="newAddress_country" value="Country"/>
                        <h:inputText id="newAddress_country"  class="form-control input_text"  value="#{customerProfileManagedBean.address.country}" maxlength="32" required="true" requiredMessage="Address is required"/>
                    </div>
                    <div class="form-group">
                        <h:outputLabel class="control-label" for="newAddress_postalCode" value="Postal Code"/>
                        <h:inputText id="newAddress_postalCode"  class="form-control input_text"  value="#{customerProfileManagedBean.address.postalCode}" maxlength="32" required="true" requiredMessage="Postal Code is required"/>
                    </div>
                    <div class="form-group">
                        <h:commandButton type="button" class="btn btn-default page_button" style="width:120px;" value="Add Address" actionListener="#{customerProfileManagedBean.createAddress}" >
                            <f:ajax execute="@form"/>
                        </h:commandButton>
                    </div>    
                </h:form>
                
            </div>
            <div class="modal-footer">
              <h:commandButton type="button" class="btn btn-default page_button" style="width:80px;" value="Save" actionListener="#{customerProfileManagedBean.updateCustomerProfile}" ><f:ajax execute="@form"/></h:commandButton>
              <button type="button" class="btn btn-default" data-dismiss="modal" style="width:80px;">Cancel</button>
            </div>
            </h:form>
          </div>
        </div>
      </div>
      
      
      <!-- Modal windows-->
      <div class="modal fade" id="myPassword" role="dialog" style="padding-top:100px;">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header themeBg">
              <button type="button" class="close modal-close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title text-center">Change Password</h4>
            </div>
            <h:form class="form" rendered="#{!customerProfileManagedBean.customer.isFaceBook}">
              
            <div class="modal-body">
              <div class="form-group">
                <h:outputLabel class="control-label" for="password_old" value="Old Password"/>
                <h:inputSecret id="password_old"  class="form-control input_text"  value="#{customerProfileManagedBean.oldPassword}" maxlength="32" required="true" requiredMessage="First Name is required"/>
              </div>
              <h:messages id="password_error" class="error_message"/>
              
              <div class="form-group">
                <h:outputLabel class="control-label" for="password_new" value="New Password"/>
                <h:inputSecret id="password_new"  class="form-control input_text"  value="#{customerProfileManagedBean.newPassword}" maxlength="32" required="true" requiredMessage="Last Name is required"/>
              </div>
            </div>
            <div class="modal-footer">
              <h:commandButton type="button" class="btn btn-default page_button" style="width:80px;" value="Save" actionListener="#{customerProfileManagedBean.checkPassword}" >
                <f:ajax execute="@form" render="password_error"/>
              </h:commandButton>
              <button type="button" class="btn btn-default" data-dismiss="modal" style="width:80px;">Cancel</button>
            </div>              
            </h:form>
            
            <h:form class="form" rendered="#{customerProfileManagedBean.customer.isFaceBook}">
              
            <div class="modal-body">
              <div class="form-group">
                <h:outputLabel class="control-label" for="password_new" value="New Password"/>
                <h:inputSecret id="password_new"  class="form-control input_text"  value="#{customerProfileManagedBean.newPassword}" maxlength="32" required="true" requiredMessage="Last Name is required"/>
              </div>
            </div>
            <div class="modal-footer">
              <h:commandButton type="button" class="btn btn-default page_button" style="width:80px;" value="Save" actionListener="#{customerProfileManagedBean.checkPassword}" >
                <f:ajax execute="@form"/>
              </h:commandButton>
              <button type="button" class="btn btn-default" data-dismiss="modal" style="width:80px;">Cancel</button>
            </div>              
            </h:form>
          </div>
        </div>
      </div>
      <div class="col-sm-4">
        <span class="glyphicon glyphicon-signal logo"></span>
      </div>
    </div>
  </cc:implementation>
</html>